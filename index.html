<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Function library example</title>
  <button class="rock">Rock</button>
  <button class="paper">Paper</button>
  <button class="scissors">Scissors</button>
  <button class="playAgain" style="display: none;">Play again</button>
  <div id="container"></div>
  <div id="containerScore"></div>
</head>
<body>

	<script>

		const rock  = document.querySelector('.rock');
		const paper = document.querySelector('.paper');
		const scissors = document.querySelector('.scissors');
		const playAgain = document.querySelector('.playAgain');

		rock.addEventListener('click', function() {
			playerSelection = 'rock';
			game();
		});
		paper.addEventListener('click', function() {
			playerSelection = 'paper';
			game();
		});
		scissors.addEventListener('click', function() {
			playerSelection = 'scissors';
			game();
		});
		playAgain.addEventListener('click', function(){
			resetGame();
		})
		
		function computerPlay(){
			let computerHand = Math.floor(Math.random() * 3);
			if (computerHand === 0){
				return "rock";
			} else if (computerHand === 1) {
				return "paper";
			} else {
				return "scissors";
			}
		}
		
		function playRound(playerSelection, computerSelection){
			if(playerSelection === computerSelection){
				return "Tie!";
			} else if(playerSelection === "rock" && computerSelection === "scissors"){
				return "User wins!";
			} else if(playerSelection === "scissors" && computerSelection === "paper"){
				return "User wins!";
			} else if(playerSelection === "paper" && computerSelection === "rock"){
				return "User wins!";
			} else {
				return "Computer wins!"
			}
		}

		function consoleMatch(playerSelection, computerSelection){
			const container = document.querySelector('#container');
			const containerScore = document.querySelector('#containerScore');
			if(wonGame > lostGame){
				container.textContent = "User play " + playerSelection + ". Computer play " + computerSelection;
				containerScore.textContent = "Score => User : " + wonGame + " Computer : " + lostGame;
			} else if (lostGame > wonGame){

				container.textContent = "User play " + playerSelection + ". Computer play " + computerSelection;
				containerScore.textContent = "Score => User : " + wonGame + " Computer : " + lostGame;
			} else {
				container.textContent = "User play " + playerSelection + ". Computer play " + computerSelection;
				containerScore.textContent = "Score => User : " + wonGame + " Computer : " + lostGame;
			}
		}

		let countRoundFive = 0;
		function countRound(){
			countRoundFive++;
		}

		function resetGame() {
			container.textContent = "";
			containerScore.textContent ="";
			countRoundFive = 0;
			wonGame = 0;
			lostGame = 0;
			rock.removeAttribute('style', 'display: none;');
			paper.removeAttribute('style', 'display: none;');
			scissors.removeAttribute('style', 'display: none;');
			playAgain.setAttribute('style', 'display: none;');
		}

		function hideButtons() {
			rock.setAttribute('style', 'display: none;');
			paper.setAttribute('style', 'display: none;');
			scissors.setAttribute('style', 'display: none;');
			playAgain.setAttribute('style', 'display: inline-block;');
		}

		function countToFive(){
			if(countRoundFive >= 5){
				if(wonGame > lostGame){
					container.textContent = "User wins by " + wonGame + " : " + lostGame;
					hideButtons();
				} else if(lostGame > wonGame) {
					container.textContent = "Computer wins by " + wonGame + " : " + lostGame;
					hideButtons();
				} else {
					container.textContent = "Draw by " + wonGame + " : " + lostGame;
					hideButtons();
				}
			}
		}


		let wonGame = 0;
		let lostGame = 0;
		let ties = 0;
		function game(){
			let computerSelection = computerPlay();
			let round = (playRound(playerSelection, computerSelection));
			if (round === "User wins!"){
				wonGame++;
			} else if(round === "Computer wins!") {
				lostGame++;
			} else {
				ties++;
			}
			countRound(countRoundFive);
			consoleMatch(playerSelection, computerSelection);
			countToFive();
		}

	</script>

</body>
</html>